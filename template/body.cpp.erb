#include "<%= class_name %>.h"

USING_NS_CC;
USING_NS_CC_EXT;
using namespace cocosbuilder;

<%= class_name %>::<%= class_name %>()
<%= member_variables.map{|var| var['memberVarAssignmentName'] + "(NULL)"}.join(",\n").tap{|s| s.length > 0 && s.gsub!(/^/, ": ") } %>
{}

<%= class_name %>::~<%= class_name %>()
{
<% member_variables.each do |var| %>
    CC_SAFE_RELEASE(<%= var['memberVarAssignmentName'] %>);
<% end %>
}

void <%= class_name %>::onNodeLoaded(cocos2d::Node * node,  cocosbuilder::NodeLoader * nodeLoader) {
}


SEL_MenuHandler <%= class_name %>::onResolveCCBCCMenuItemSelector(Ref * pTarget, const char * pSelectorName) {
    return NULL;    
}

Control::Handler <%= class_name %>::onResolveCCBCCControlSelector(Ref * pTarget, const char * pSelectorName) {
    return NULL;
}

bool <%= class_name %>::onAssignCCBMemberVariable(Ref * pTarget, const char * pMemberVariableName, Node * pNode) {
<% member_variables.each do |var| %>
    CCB_MEMBERVARIABLEASSIGNER_GLUE(this, "<%= var["memberVarAssignmentName"]%>", <%= var["baseClass"].gsub(/^CC/, '') %>*, this-><%= var["memberVarAssignmentName"]%>);
<% end %>
    return false;
}

bool <%= class_name %>::onAssignCCBCustomProperty(Ref* pTarget, const char* pMemberVariableName, const Value& pCCBValue)
{
    bool bRet = false;
    if (pTarget == this)
    {
    <% custom_properties.each.with_index do |property, i| %>
        <% if i > 0 %>else <% end %>if (0 == strcmp(pMemberVariableName, "<%= property['name'] %>"))
        {
            this-><%= property['name'] %> = pCCBValue.as<%= property_type[property['type']].capitalize %>();
            log("<%= property['name'] %> = %d", <%= property['name'] %>);
            bRet = true;
        }
    <% end %>
    <% if false %>
        else if ( 0 == strcmp(pMemberVariableName, "mCustomPropertyFloat"))
        {
            this->mCustomPropertyFloat = pCCBValue.asFloat();
            log("mCustomPropertyFloat = %f", mCustomPropertyFloat);
            bRet = true;
        }
        else if ( 0  == strcmp(pMemberVariableName, "mCustomPropertyBoolean"))
        {
            this->mCustomPropertyBoolean = pCCBValue.asBool();
            log("mCustomPropertyBoolean = %d", mCustomPropertyBoolean);
            bRet = true;
        }
        else if ( 0  == strcmp(pMemberVariableName, "mCustomPropertyString"))
        {
            this->mCustomPropertyString = pCCBValue.asString();
            log("mCustomPropertyString = %s", mCustomPropertyString.c_str());
            bRet = true;
        }
    <% end %>    
    }

    return bRet;
}
